<html>

<head>
	<title>PiCluster Web Console</title>
	<script src="/assets/jquery.js"></script>
	<script src="/assets/jquery-ui.js"></script>
	<link rel="stylesheet" href="/assets/picluster.js">
		<script src="assets/user.js"></script>
	<script src="/assets/distLogo.js"></script>
	<script src="/assets/moment.js"></script>

	<link rel="stylesheet" href="/assets/jquery-ui.css">
	<link rel="stylesheet" href="/assets/picluster-ui.css">
	<link rel="stylesheet" href="/assets/circle.css">

	<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
	<link rel="manifest" href="/assets/images/manifest.json">
	<link rel="mask-icon" href="/assets/images/safari-pinned-tab.svg" color="#5bbad5">

	<meta name="theme-color" content="#ffffff">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	
	<script>
		// TODO: Handle variables in DB
		var manage_container = '';
		var manage_image = '';
		var manage_function = '';
		var manage_function_uuid = '';
		var token = '';

		/** TODO: Refactor into link generation engine
				function build_doc_links() {
					var output = '';

					$.get("/listdocs", function(doc_list) {
						for (var i in doc_list) {
							output += "$('#doc'" + i + ").click(function() { $('iframe_a').load('/docs.html?doc_id=doc'" + i + ") });";
						}
					});

					return output;
				}

				function build_docs_nav_menu() {
					var output = '';
					output += '<ul class="dropdown">';

					$.get("/listdocs", function(doc_list) {
						for (var i in doc_list) {
							var doc_id = "doc" + i;
							$("<li><a href='#' id='" + doc_id + "' onclick='stinky_linker(\"" + doc_id + "\")'>" + doc_list[i] + "</a></li>").appendTo("#nav_docs > ul");
						}
					});

					output += '</ul>';
					$('#nav_docs').append(output);
				}

				function stinky_linker(doc_id) {
					$('#content').load('/docs.html?doc_id=' + doc_id);
				}
		*/

		$(document).ready(function() {
			// Nodes dropdown
			$('#nodes-list').click(function() {
				$('#content').load('/nodes-list.html');
			});
			$('#nodes-manage').click(function() {
				$('#content').load('/nodes-manage.html');
			});
			$('#swarm').click(function() {
				$('#content').load('/swarm.html');
			});

			// Containers dropdown
			$('#containers-layout').click(function() {
				$('#content').load('/containers-layout.html');
			});
			$('#containers-manage').click(function() {
				$('#content').load('/containers-manage.html');
			});

			// Images dropdown
			$('#images-layout').click(function() {
				$('#content').load('/images-layout.html');
			});
			$('#images-manage').click(function() {
				$('#content').load('/images-manage.html');
			});

			// Functions dropdown
			$('#functions-create').click(function() {
				$('#content').load('/functions-create.html');
			});
			$('#functions-remove').click(function() {
				$('#content').load('/functions-clear.html');
			});
			$('#functions-current').click(function() {
				$('#content').load('/functions-current.html');
			});
			$('#functions-viewer').click(function() {
				$('#content').load('/functions-viewer.html');
			});

			// Operation dropdown
			$('#config-edit').click(function() {
				$('#content').load('/config-edit.html?token=' + token);
			});
			$('#exec').click(function() {
				$('#content').load('/exec.html?token=' + token);
			});
			$('#heartbeat').click(function() {
				$('#content').load('/heartbeat.html');
			});
			$('#images-prune').click(function() {
				$('#content').load('/images-prune.html');
			});
			$('#terminal').click(function() {
				$('#content').load('/terminal.html');
			});
			$('#monitoring').click(function() {
				$('#content').load('/monitoring.html?token=' + token);
			});
			$('#elasticsearch-config').click(function() {
				$('#content').load('/elasticsearch.html?token=' + token);
			});

			// Logs dropdown
			$('#log').click(function() {
				$('#content').load('/log.html');
			});
			$('#syslog').click(function() {
				$('#content').load('/syslog.html');
			});
			$('#rsyslog').click(function() {
				$('#content').load('/rsyslog.html');
			});

			// User dropdown
			$('#user').click(function() {
				$('#content').load('/user.html');
			});
			$('#logout').click(function() {
				$('#content').load('/api/logout');
			});

			// Docs dropdown
			//$('#docs').click(function() {
			//		$('#content').load('/docs.html');
			//	});

			//$('#doc1').click(function() {
			//	$('#content').load('/docs.html?doc_id=doc1');
			//});

			//build_doc_links();

			// Provide dropdown menu when javascript disabled
			$('nav li ul').hide().removeClass('dropdown');

			// Render menu dropdown the right way
			$('nav li').hover(function() {
				$('ul', this).stop().slideDown(250);
			}, function() {
				$('ul', this).stop().slideUp(250);
			});
		});

		/** yea, lets do this whole "menu" rendering the right way
		$("html").click(function() {
			$(".dropdown").hide();
		});

		$("nav ul li a:not(:only-child)").click(function(e) {
			$(this).siblings(".dropdown").toggle();

			$(".dropdown").not($(this).siblings()).hide();
			e.stopPropagation();
		});
		*/

		/** Not needed now that authentication is handled with middleware
		function hideshow(id) {
			var element = document.getElementById(id);
			element.style.display = element.style.display == 'block' ? 'none' : 'block';
		}

		$(function() {
			hideshow('menu');
			hideshow('content');
			hideshow('menu');
			hideshow('content');
		});
		*/

		/* Not used. Why do they need to be here?
		function getToken() {
			return token;
		}

		function getVersion() {
			return version;
		}
		*/
	</script>
</head>

<body>
	<div id="menu">
		<nav>
			<ul>
				<li><a href='/' id="logo"><img src="/assets/images/sphere.png" id="nav_logo_image"></a>
				<li><a href="#!">Nodes</a>
					<ul class="dropdown">
						<li><a href="#" id="nodes-list">List</a></li>
						<li><a href="#" id="nodes-manage">Manage</a></li>
						<li><a href="#" id="swarm">Swarm Setup</a></li>
					</ul>
				</li>
				<li><a href="#!">Containers</a>
					<ul class="dropdown">
						<li><a href="#" id="containers-layout">List</a></li>
						<li><a href="#" id="containers-manage">Manage</a></li>
					</ul>
				</li>
				<li><a href="#!">Images</a>
					<ul class="dropdown">
						<li><a href="#" id="images-layout">List</a></li>
						<li><a href="#" id="images-manage">Manage</a></li>
					</ul>
				</li>
				<li><a href="#!">Functions</a>
					<ul class="dropdown">
						<li><a href="#" id="functions-create">Create</a></li>
						<li><a href="#" id="functions-remove">Remove</a></li>
						<li><a href="#" id="functions-current">Current</a></li>
						<li><a href="#" id="functions-viewer">Viewer</a></li>
					</ul>
				</li>
				<li><a href="#!">Operations</a>
					<ul class="dropdown">
						<li><a href="#" id="config-edit">Edit Config</a></li>
						<li><a href="#" id="exec">Run Command(s)</a></li>
						<li><a href="#" id="heartbeat">Heartbeat</a></li>
						<li><a href="#" id="images-prune">Clean Docker</a></li>
						<li><a href="#" id="terminal">Terminal</a></li>
						<li><a href="#" id="monitoring">Monitoring</a></li>
						<li><a href="#" id="elasticsearch-config">Configure Elasticsearch</a></li>
					</ul>
				</li>
				<li><a href="#!">Logs</a>
					<ul class="dropdown">
						<li><a href="#" id="log">PiCluster Logs</a></li>
						<li><a href="#" id="syslog">Syslog</a></li>
						<li><a href="#" id="rsyslog">Rsyslog</a></li>
					</ul>
				</li>
				<li><a href="#!">User</a>
					<ul class="dropdown">
						<li><a href="#" id="user">User</a></li>
						<li><a href="#" id="logout">Logout</a></li>
					</ul>
				</li>
			</ul>
		</nav>
	</div>

	<div id="content"></div>

	<!-- its time to get rid of this lop of shit
	<div id="div_iframe">
		<iframe src="/blank.html" id="iframe_a" name="iframe_a">
	</div>
	-->
</body>

</html>
